import{u as b,r as m,_ as g,b as y,j as e,L as f,I as v,a as S,c as k,s as L}from"./index-DufK7jcw.js";import{c as E,a as w}from"./index.esm-CwQSNrgd.js";const C=()=>{const n=b(),[u,o]=m.useState(!1),s="http://35.154.167.170:3000",i=5;return{login:async(p,a)=>{try{o(!0);const t=await(await fetch(`${s}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:p,password:a,role_id:i})})).json();if(t.statusCode==200)return g.success(t.message||"user login successful!",{className:"toast-success"}),localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user)),n("/"),t.data;g.error("Invalid credentials. Please check your username and password.",{className:"toast-error"})}catch{g.error("Oops! Something went wrong during the login process. Please try again.",{className:"toast-error"})}finally{o(!1)}},loading:u}},I=()=>{const n=y(),{login:u,loading:o}=C(),[s,i]=m.useState({}),[c,p]=m.useState(!1),[a,h]=m.useState({username:"",password:""}),t=l=>{const{name:r,value:d}=l.target;h({...a,[r]:d})},j=E().shape({username:w().min(10,"Username must be at least 10 characters").required("Username is required"),password:w().min(6,"Password must be at least 6 characters").required("Password is required")}),N=async l=>{l.preventDefault();try{await j.validate(a,{abortEarly:!1});const r=await u(a.username,a.password);r&&(n(k(r.user)),n(L(!!r.token))),i("")}catch(r){const d={};r.inner.forEach(x=>{d[x.path]=x.message}),i(d)}};return e.jsx("section",{className:" flex justify-center items-center p-6 h-[100vh] w-[100vw]",children:e.jsxs("form",{className:"login-form-container",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center gap-8 laptop-l:gap-6",children:[e.jsx("img",{src:"sc-logo.png",alt:"Sikka Cleaner Logo",loading:"lazy",className:"h-16 w-auto laptop-l:h-14"}),e.jsx("h2",{className:"text-[2.4rem] leading-[1.5] font-bold text-[var(--primary)] laptop-l:text-[2rem]",children:"Login in to your account"})]}),e.jsxs("div",{className:`flex flex-col ${s.username||s.password?"gap-6":"gap-10"}`,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"form-label",children:"Username"}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{id:"username",name:"username",placeholder:"Email or mobile number",className:"form-input",value:a.username,onChange:t})}),s.username&&e.jsx("p",{className:"error-label",children:s.username})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"password",className:"form-label",children:"Password"}),e.jsx("div",{className:"text-lg",children:e.jsx(f,{to:"/forget-password",className:"forget-link","aria-label":"Forget password",title:"Forget password",children:"Forgot password ?"})})]}),e.jsxs("div",{className:"mt-2 relative",children:[e.jsx("input",{id:"password",name:"password",type:c?"text":"password",placeholder:"password",className:"form-input",value:a.password,onChange:t}),e.jsx("span",{className:"absolute inline-block top-1/2 right-4 -translate-y-1/2 cursor-pointer",onClick:()=>p(!c),children:c?e.jsx(v,{className:"h-8 w-8 fill-[#83848a]"}):e.jsx(S,{className:"h-8 w-8 fill-[#83848a]"})})]}),s.password&&e.jsx("p",{className:"error-label",children:s.password})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"login-btn",title:"login","aria-label":"login",onClick:l=>N(l),disabled:o,children:o?"Logging in...":"Login"})}),e.jsxs("p",{className:"text-center text-lg text-[#83848a]",children:["Not a member?",e.jsx(f,{to:"/signup",className:"ml-4 text-[#818cf8]","aria-label":"register now",title:"register",children:"Register"})]})]})})};export{I as default};
