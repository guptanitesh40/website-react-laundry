import{_ as b,r as i,b as S,j as e,a1 as L,c as I}from"./index-C_mM-yrD.js";import{L as A}from"./Loading-BkyZZQ57.js";const E=()=>{const p="http://3.110.208.70:3000",d=localStorage.getItem("token");return{getUserDetail:async()=>{try{const n=await fetch(`${p}/user/customer`,{method:"GET",headers:{Authorization:`Bearer ${d}`}}),f=await n.json();if(n.ok)return f.data;b.error("Unable to retrieve user details. Please try again later.",{className:"toast-error"})}catch{b.error("Failed to fetch user information. Please check your connection.",{className:"toast-error"})}}}},R=()=>{const[p,d]=i.useState(!1),g="http://3.110.208.70:3000",n=localStorage.getItem("token");return{updateUserDetail:async t=>{var x,h;d(!0);let s=new FormData;s.append("first_name",t.first_name),s.append("last_name",t.last_name),s.append("email",t.email),s.append("mobile_number",t.mobile_number),s.append("gender",t.gender),t.image&&s.append("image",t.image),t.id_proof&&s.append("id_proof",t.id_proof);try{const o=await fetch(`${g}/user/customer`,{method:"PUT",headers:{Authorization:`Bearer ${n}`},body:s}),m=await o.json();return o.ok?(b.success("Your profile details have been successfully updated!",{className:"toast-success"}),(h=(x=m==null?void 0:m.data)==null?void 0:x.user)==null?void 0:h.updatedData):(b.error("Unable to update your profile at the moment. Please try again later.",{className:"toast-error"}),null)}catch{return b.error("Profile update failed! Please check the information and try again.",{className:"toast-error"}),null}finally{d(!1)}},loading:p}},O=()=>{const p=S(),{getUserDetail:d}=E(),{updateUserDetail:g,loading:n}=R(),[f,t]=i.useState(null),[s,x]=i.useState(null),[h,o]=i.useState(!1),[m,v]=i.useState(!0),[l,u]=i.useState({first_name:"",last_name:"",email:"",mobile_number:"",gender:0,id_proof:null,image:null}),_=async r=>{if(r.preventDefault(),h){const a=await g(l);a&&p(I(a))}},j=r=>{const{name:a,value:c}=r.target;a=="gender"?(o(!0),u({...l,[a]:Number(c)})):(o(!0),u({...l,[a]:c}))},U=r=>{let a=r.target.files[0];a&&(o(!0),u({...l,id_proof:a}))},w=r=>{let a=r.target.files[0];if(a){o(!0);const c=URL.createObjectURL(a);t(c),u({...l,image:a})}};return i.useEffect(()=>{(async()=>{const a=await d();if(a){const{first_name:c,last_name:F,email:k,mobile_number:P,gender:C,image:N,id_proof:y}=a.user;u({first_name:c,last_name:F,email:k,mobile_number:P,gender:C});const D=N||"/default_pfp.png";y&&x(y),t(D),v(!1)}})()},[]),m?e.jsx(A,{}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"dash-section-head mb-8 laptop-m:mb-6 laptop-s:mb-5 tab-l:mb-6 mb:mb-4",children:"Customer Master - Details"}),e.jsx("div",{className:"cus-detail-container",children:e.jsxs("div",{className:"p-14 flex items-start gap-20 laptop-m:p-12 laptop-m:gap-16 laptop:gap-12 laptop-s:p-10 laptop-s:gap-10 tab-l:p-8 tab-l:gap-8 tab-s:flex-col tab-s:p-10 tab:p-8 mb:p-6 mb:gap-6",children:[e.jsxs("div",{className:"profile-img-container",children:[e.jsx("img",{src:f,alt:"Avatar",className:"h-full w-full rounded-full border-[1.5px] border-[var(--black)] laptop-s:border"}),e.jsx("button",{className:"edit-profile-img",onClick:()=>document.getElementById("profileImageInput").click(),children:e.jsx(L,{className:"inline-block h-8 w-8 fill-white laptop-m:h-7 laptop-m:w-7 tab-l:h-5 tab-l:w-5 mb:h-4 mb:w-4"})}),e.jsx("input",{type:"file",id:"profileImageInput",className:"hidden",accept:"image/*",onChange:w})]}),e.jsx("div",{className:"grow tab-s:self-stretch",children:e.jsx("form",{className:"user-detail",onSubmit:_,children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-12 gap-y-14 laptop-s:gap-x-10 laptop-s:gap-y-12 tab-l:gap-x-8 tab-l:gap-y-10 tab-s:grid-cols-[repeat(auto-fill,_minmax(22.5rem,_1fr))] tab-s:gap-10 tab:grid-cols-[repeat(auto-fill,_minmax(20rem,_1fr))] tab:gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"firstname",children:"first name"}),e.jsx("input",{id:"firstname",type:"text",name:"first_name",value:l.first_name,onChange:j,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none mb:border"})]}),e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"lastname",children:"last name"}),e.jsx("input",{id:"lastname",type:"text",name:"last_name",value:l.last_name,onChange:j,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none mb:border"})]}),e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"email",children:"email"}),e.jsx("input",{readOnly:!0,id:"email",type:"text",name:"email",value:l.email,className:"readonly-input border-[1.5px] border-indigo-200 focus:outline-none mb:border"})]}),e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"mobile",children:"mobile"}),e.jsx("input",{readOnly:!0,id:"mobile",type:"text",name:"mobile_number",value:l.mobile_number,className:"readonly-input border-[1.5px] border-indigo-200 focus:outline-none mb:border"})]}),e.jsxs("div",{className:"col-span-2 flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2 tab-s:col-span-1",children:[e.jsx("label",{htmlFor:"document",children:"Update/Add document"}),e.jsx("input",{id:"document",type:"file",onChange:U,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none mb:border"}),s&&e.jsx("div",{className:"flex items-start",children:e.jsx("a",{href:s,className:"inline-block text-indigo-600 hover:underline laptop-m:text-[1.4rem] tab-l:text-xl mb:text-base",target:"__blank",children:"view document"})})]}),e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"gender",children:"gender"}),e.jsxs("div",{className:"grow flex items-stretch justify-stretch gap-8 laptop-m:gap-6 mb:gap-4",children:[e.jsxs("label",{htmlFor:"male",className:"flex items-center justify-center gap-2 border border-indigo-300 py-[1.25rem] rounded-lg px-4 tab-l:p-4 mb:p-3",children:[e.jsx("input",{id:"male",type:"radio",name:"gender",value:1,onChange:j,checked:l.gender==1}),e.jsx("span",{className:"text-[1.5rem] leading-[1.7rem] text-[var(--black)] laptop-m:text-[1.4rem] tab-l:text-xl mb:text-base",children:"Male"})]}),e.jsxs("label",{htmlFor:"female",className:"flex items-center justify-center gap-2 border border-indigo-300 py-[1.25rem] rounded-lg px-4 tab-l:p-4 mb:p-3",children:[e.jsx("input",{id:"female",type:"radio",name:"gender",value:2,onChange:j,checked:l.gender==2}),e.jsx("span",{className:"text-[1.5rem] leading-[1.7rem] text-[var(--black)] laptop-m:text-[1.4rem] tab-l:text-xl mb:text-base",children:"Female"})]})]})]}),e.jsx("div",{className:"col-span-2 tab-s:col-span-1",children:e.jsx("button",{className:"update-btn",type:"submit",disabled:n,children:n?"updating...":"update"})})]})})})]})})]})};export{O as default};
