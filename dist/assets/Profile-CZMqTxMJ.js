import{_ as m,r as i,j as e,z as D}from"./index-CVJtAuXu.js";import{L as S}from"./Loading-BbArYI7l.js";const P=()=>{const o="http://35.154.167.170:3000",d=localStorage.getItem("token");return{getUserDetail:async()=>{try{const a=await fetch(`${o}/user/customer`,{method:"GET",headers:{Authorization:`Bearer ${d}`}}),t=await a.json();if(a.ok)return t.data;m.error("Failed to fetch user deatil!")}catch{m.error("Failed to fetch user deatil!")}}}},I=()=>{const o="http://35.154.167.170:3000",d=localStorage.getItem("token");return{updateUserDetail:async a=>{let t=new FormData;t.append("first_name",a.first_name),t.append("last_name",a.last_name),t.append("email",a.email),t.append("mobile_number",a.mobile_number),t.append("gender",a.gender),a.image&&t.append("image",a.image),a.id_proof&&t.append("id_proof",a.id_proof);try{const u=await fetch(`${o}/user/customer`,{method:"PUT",headers:{Authorization:`Bearer ${d}`},body:t}),x=await u.json();u.ok?m.success("user data updated successfully"):m.error(x.message)}catch{m.error("Failed to update user data!")}}}},E=()=>{const{getUserDetail:o}=P(),{updateUserDetail:d}=I(),[f,a]=i.useState(null),[t,u]=i.useState(null),[x,p]=i.useState(!1),[l,c]=i.useState({first_name:"",last_name:"",email:"",mobile_number:"",gender:0,id_proof:null,image:null}),[j,v]=i.useState(!0),N=async r=>{r.preventDefault(),x&&await d(l)},g=r=>{const{name:s,value:n}=r.target;s=="gender"?(p(!0),c({...l,[s]:Number(n)})):(p(!0),c({...l,[s]:n}))},_=r=>{let s=r.target.files[0];s&&(p(!0),c({...l,id_proof:s}))},y=r=>{let s=r.target.files[0];if(s){p(!0);const n=URL.createObjectURL(s);a(n),c({...l,image:s})}};return i.useEffect(()=>{(async()=>{const s=await o();if(s){const{first_name:n,last_name:F,email:w,mobile_number:U,gender:k,image:h,id_proof:b}=s.user;c({first_name:n,last_name:F,email:w,mobile_number:U,gender:k});const C=h||"/default_avatar.png";b&&u(b),a(C),v(!1)}})()},[]),j?e.jsx(S,{}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"dash-section-head mb-5",children:"Customer Master - Details"}),e.jsx("div",{className:"cus-detail-container",children:e.jsxs("div",{className:"p-14 flex items-start gap-20",children:[e.jsxs("div",{className:"profile-img-container relative",children:[e.jsx("img",{src:f,alt:"Avatar",className:"h-full w-full rounded-full border-[1.5px] border-[var(--black)]"}),e.jsx("button",{className:"edit-profile-img",onClick:()=>document.getElementById("profileImageInput").click(),children:e.jsx(D,{className:"inline-block h-full w-full fill-white p-3"})}),e.jsx("input",{type:"file",id:"profileImageInput",className:"hidden",accept:"image/*",onChange:y})]}),e.jsx("div",{className:"grow",children:e.jsx("form",{className:"user-detail",onSubmit:N,children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-12 gap-y-14",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"firstname",children:"first name"}),e.jsx("input",{id:"firstname",type:"text",name:"first_name",value:l.first_name,onChange:g,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"lastname",children:"last name"}),e.jsx("input",{id:"lastname",type:"text",name:"last_name",value:l.last_name,onChange:g,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"email",children:"email"}),e.jsx("input",{readOnly:!0,id:"email",type:"text",name:"email",value:l.email,className:"readonly-input border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"mobile",children:"mobile"}),e.jsx("input",{readOnly:!0,id:"mobile",type:"text",name:"mobile_number",value:l.mobile_number,className:"readonly-input border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"})]}),e.jsxs("div",{className:"col-span-2 flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"document",children:"Update/Add document"}),e.jsx("input",{id:"document",type:"file",onChange:_,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"}),t&&e.jsx("div",{className:"flex items-start gap-8",children:e.jsx("a",{href:t,className:"inline-block text-indigo-600 hover:underline",target:"__blank",children:"view document"})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"gender",children:"gender"}),e.jsxs("div",{className:"grow flex items-stretch justify-stretch gap-8",children:[e.jsxs("label",{htmlFor:"male",className:"flex items-center justify-center gap-2 border border-indigo-300 py-[1.25rem] rounded-lg px-4",children:[e.jsx("input",{id:"male",type:"radio",name:"gender",value:1,onChange:g,checked:l.gender==1}),e.jsx("span",{className:"text-[1.5rem] leading-[1.7rem] text-[var(--black)]",children:"Male"})]}),e.jsxs("label",{htmlFor:"female",className:"flex items-center justify-center gap-2 border border-indigo-300 py-[1.25rem] rounded-lg px-4",children:[e.jsx("input",{id:"female",type:"radio",name:"gender",value:2,onChange:g,checked:l.gender==2}),e.jsx("span",{className:"text-[1.5rem] leading-[1.7rem] text-[var(--black)]",children:"Female"})]})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsx("button",{className:"update-btn",type:"submit",children:"update"})})]})})})]})})]})};export{E as default};
