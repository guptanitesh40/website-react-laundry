import{r as n,_ as i,c as T,u as $,j as e,L as _}from"./index-DbuANYRW.js";const z=()=>{const[g,d]=n.useState(!1),t="http://35.154.167.170:3000";return{verifyPayement:async b=>{try{d(!0);const o=await fetch(`${t}/razorpay/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),s=await o.json();o.ok?i.success(s==null?void 0:s.message):i.success("Failed to verify payement!")}catch{i.error("Failed to verify payement")}finally{d(!1)}},loading:g}},A=()=>{var v,w,k;const{verifyPayement:g,loading:d}=z(),t=T(),p=$(),[b,o]=n.useState(!0),[s,P]=n.useState({}),[L,F]=n.useState(""),S={1:"Cash on delivery",2:"Online Payement"};d&&i.success("Loading ...");const O=async c=>{const{orderDetail:l}=c,{total:m,razorpay_carrency:x,user:u,transaction_id:f}=l,{first_name:y,last_name:a,mobile_number:j}=u;try{const r={key:"rzp_test_3b3hKisTogv8or",amount:m*100,currency:x,name:"sikka cleaners",description:"Order Payment",order_id:f,handler:async function(N){const D=await g(N)},prefill:{name:y+" "+a,email:"user@gmail.com",contact:j},theme:{color:"#161F5F"}},h=new window.Razorpay(r);h.open(),h.on("payment.failed",function(N){alert(`Payment failed: ${N.error.description}`)})}catch(r){i.success(r)}};if(n.useEffect(()=>{var c,l,m,x,u,f,y;if(!t.state)p("/cart");else{((c=t==null?void 0:t.state)==null?void 0:c.paymentMethod)===2&&O((l=t==null?void 0:t.state)==null?void 0:l.result),P((x=(m=t==null?void 0:t.state)==null?void 0:m.result)==null?void 0:x.orderDetail);const a=new Date((y=(f=(u=t==null?void 0:t.state)==null?void 0:u.result)==null?void 0:f.orderDetail)==null?void 0:y.created_at),j=a.getDate(),r=a.toLocaleString("en-US",{month:"short"}),h=a.getFullYear();F(`${j} ${r} ${h}`),o(!1)}},[t,t.state,p]),t.state)return b?e.jsx("h1",{children:"Loading..."}):e.jsx("section",{className:"bg-white py-8 antialiased md:py-24",children:e.jsxs("div",{className:"mx-auto px-4 flex flex-col items-stretch gap-10 order-container",children:[e.jsx("h2",{className:"text-center text-3xl font-bold leading-9 tracking-tight text-gray-900",children:"Thanks for your order!"}),e.jsxs("p",{className:"text-[1.5rem] leading-[2.6rem] font-normal text-[var(--black)]",children:["Your order"," ",e.jsx("span",{className:"font-medium text-gray-900",children:`#${s.order_id}`})," ","will be processed within 24 hours during working days. We will notify you by email once your order has been shipped."]}),e.jsxs("div",{className:"rounded-lg border border-gray-50 bg-[#F9FAFB] p-8 mb-6 flex flex-col gap-6 text-[1.5rem]",children:[e.jsxs("dl",{className:"flex items-center justify-between gap-12",children:[e.jsx("dt",{className:"font-medium mb-1 text-gray-500",children:"Date"}),e.jsx("dd",{className:"font-medium text-[var(--black)]",children:L})]}),e.jsxs("dl",{className:"flex items-center justify-between gap-12",children:[e.jsx("dt",{className:"font-medium mb-1 text-gray-500",children:"Payment Method"}),e.jsx("dd",{className:"font-medium text-[var(--black)] sm:text-end",children:S[1]})]}),e.jsxs("dl",{className:"flex items-center justify-between gap-12",children:[e.jsx("dt",{className:"font-medium mb-1 text-gray-500",children:"Name"}),e.jsx("dd",{className:"font-medium text-[var(--black)] sm:text-end",children:((v=s==null?void 0:s.user)==null?void 0:v.first_name)+" "+((w=s==null?void 0:s.user)==null?void 0:w.last_name)})]}),e.jsxs("dl",{className:"flex items-center justify-between gap-12",children:[e.jsx("dt",{className:"font-medium mb-1 text-gray-500",children:"Address"}),e.jsx("dd",{className:"font-medium text-[var(--black)] sm:text-end",children:s.address_details})]}),e.jsxs("dl",{className:"flex items-center justify-between gap-12",children:[e.jsx("dt",{className:"font-medium mb-1 text-gray-500",children:"Phone"}),e.jsxs("dd",{className:"font-medium text-[var(--black)] sm:text-end",children:["+91 ",(k=s==null?void 0:s.user)==null?void 0:k.mobile_number]})]}),e.jsxs("dl",{className:"flex items-center justify-between gap-12",children:[e.jsx("dt",{className:"font-medium mb-1 text-gray-500",children:"Total Amount"}),e.jsxs("dd",{className:"font-medium text-[var(--black)] sm:text-end",children:["â‚¹ ",s.total]})]})]}),e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx(_,{to:"/dashboard/home",className:"text-white bg-indigo-700 hover:bg-indigo-800 focus:ring-4 focus:ring-indigo-200 rounded-lg text-xl px-5 py-4 font-semibold",children:"Track your order"}),e.jsx(_,{to:"/services",className:"px-5 py-4 text-xl font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:text-indigo-700 focus:ring-4 focus:ring-gray-200",children:"Return to shopping"})]})]})})};export{A as default};
