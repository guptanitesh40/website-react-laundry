import{r as n,_ as h,a as F,d as R,j as s,I as j,b as y}from"./index-D8wRbMS6.js";/* empty css               */import{c as $,a as v,b as q}from"./index.esm-BZjW1F8T.js";const I=()=>{const[r,d]=n.useState(!1),i="http://3.110.208.70:3000";return{resetPassword:async(f,p,o)=>{try{d(!0);const l=await fetch(`${i}/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mobile_number:Number(f),otp:Number(p),new_password:o})}),w=await l.json();return l.ok?(h.success(w.message||"Password reset successfully",{className:"toast-success"}),{success:!0}):(h.error(w.message||"Failed to reset password",{className:"toast-error"}),{success:!1})}catch{return h.error("Failed to reset password",{className:"toast-error"}),{success:!1}}finally{d(!1)}},loading:r}},D=()=>{var P,N;const r=F(),{resetPassword:d,loading:i}=I(),e=R(),f=(P=e==null?void 0:e.state)==null?void 0:P.mobile_number,p=(N=e==null?void 0:e.state)==null?void 0:N.otp,[o,l]=n.useState({}),[w,b]=n.useState(!1),[m,C]=n.useState({newPassword:!1,confPassword:!1}),[c,E]=n.useState({newPassword:"",confPassword:""}),S=async()=>{r("/login")},x=a=>{C(t=>({...t,[a]:!t[a]}))},_=async()=>{try{await k.validate(c,{abortEarly:!1}),b(!1),l({}),(await d(f,p,c.confPassword)).success&&r("/login")}catch(a){b(!0);const t={};a.inner.forEach(u=>{t[u.path]=u.message}),l(t)}},g=a=>{const{name:t,value:u}=a.target;E({...c,[t]:u})},k=$().shape({newPassword:v().matches(/[a-zA-Z]/,"Password must contain at least one letter").matches(/[0-9]/,"Password must contain at least one number").min(6,"Password must be 6 character long").required("new password is required"),confPassword:v().oneOf([q("newPassword"),null],"Passwords must match").required("Confirmation password is required")});return n.useEffect(()=>{e.state||r("/login")},[e.state,r]),s.jsx("section",{className:"bg-white grid place-items-center p-6 min-h-screen w-full overflow-auto tab:p-8 mb-l:p-6 mb:p-4",children:s.jsxs("form",{className:`reset-password-container flex flex-col ${w?"gap-6":"gap-10"}`,children:[s.jsx("h2",{className:"capitalize text-center text-[2.4rem] leading-[1.5] font-bold text-[var(--black)] laptop-l:text-[2rem] mb-l:text-[1.8rem]",children:"Reset Password"}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("label",{htmlFor:"new_password",className:"forget-label !m-0",children:"New password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"new_password",type:m.newPassword?"text":"password",name:"newPassword",placeholder:"New password",className:"forget-input",value:c.newPassword,onChange:g}),s.jsx("span",{className:"absolute cursor-pointer top-1/2 right-4 -translate-y-1/2 h-12 w-12 flex justify-center items-center rounded-full hover:bg-gray-100",onClick:()=>x("newPassword"),children:m.newPassword?s.jsx(j,{className:"h-8 w-8 fill-[#83848a]"}):s.jsx(y,{className:"h-8 w-8 fill-[#83848a]"})})]}),o.newPassword&&s.jsx("span",{className:"forget-error-label !p-0",children:o.newPassword})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("label",{htmlFor:"conf_password",className:"forget-label",children:"Confirm password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{name:"confPassword",id:"conf_password",type:m.confPassword?"text":"password",placeholder:"Confirm password",className:"forget-input",value:c.confPassword,onChange:g}),s.jsx("span",{className:"absolute cursor-pointer top-1/2 right-4 -translate-y-1/2 h-12 w-12 flex justify-center items-center rounded-full hover:bg-gray-100",onClick:()=>x("confPassword"),children:m.confPassword?s.jsx(j,{className:"h-8 w-8 fill-[#83848a]"}):s.jsx(y,{className:"h-8 w-8 fill-[#83848a]"})})]}),o.confPassword&&s.jsx("span",{className:"forget-error-label !p-0",children:o.confPassword})]}),s.jsxs("div",{className:"flex justify-between items-center py-2",children:[s.jsx("button",{type:"button",className:"cancel-btn",onClick:S,children:"cancel"}),s.jsx("button",{type:"button",className:"submit-btn",onClick:_,disabled:i,children:i?"loading...":"submit"})]})]})})};export{D as default};
