import{r as h,_ as x,u as v,a as y,j as e,L as w,I as S,b as k,c as L,s as E}from"./index-DAuzWvrj.js";import{c as C,a as j}from"./index.esm-fUAUudp_.js";const P=()=>{const[n,i]=h.useState(!1),g="http://35.154.167.170:3000",c=5;return{login:async(d,o)=>{var m,a;try{i(!0);const u=await fetch(`${g}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:d,password:o,role_id:c})}),s=await u.json();if(u.ok)return x.success(s.message||"Login successfull",{className:"toast-success"}),localStorage.setItem("token",(m=s==null?void 0:s.data)==null?void 0:m.token),localStorage.setItem("user",JSON.stringify((a=s==null?void 0:s.data)==null?void 0:a.user)),s.data;x.error("Invalid username or password.",{className:"toast-error"})}catch{x.error("Oops! Something went wrong during the login process. Please try again.",{className:"toast-error"})}finally{i(!1)}},loading:n}},O=()=>{const n=v(),i=y(),{login:g,loading:c}=P(),[t,d]=h.useState({}),[o,m]=h.useState(!1),[a,u]=h.useState({username:"",password:""}),s=l=>{const{name:r,value:p}=l.target;u({...a,[r]:p})},b=C().shape({username:j().min(10,"Username must be at least 10 characters").required("Username is required"),password:j().min(6,"Password must be at least 6 characters").required("Password is required")}),N=async l=>{l.preventDefault();try{await b.validate(a,{abortEarly:!1});const r=await g(a.username,a.password);r&&(n(L(r.user)),n(E(!!r.token)),i("/")),d("")}catch(r){const p={};r.inner.forEach(f=>{p[f.path]=f.message}),d(p)}};return e.jsx("section",{className:"flex justify-center items-center p-6 h-[100vh] w-[100vw] overflow-y-auto mb-l:p-4",children:e.jsxs("form",{className:"login-form-container",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center gap-8 laptop-l:gap-6 mb:gap-4",children:[e.jsx("img",{src:"sc-logo.png",alt:"Sikka Cleaner Logo",loading:"lazy",className:"h-16 w-auto laptop-l:h-14 mb:h-12"}),e.jsx("h2",{className:"text-[2.4rem] leading-[1.5] font-bold text-[var(--black)] laptop-l:text-[2rem] mb:text-[1.8rem]",children:"Login in to your account"})]}),e.jsxs("div",{className:`flex flex-col ${t.username||t.password?"gap-6":"gap-10 mb:gap-8"}`,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"form-label",children:"Username"}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{id:"username",name:"username",placeholder:"Email or mobile number",className:"form-input",value:a.username,onChange:s})}),t.username&&e.jsx("p",{className:"error-label",children:t.username})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"password",className:"form-label",children:"Password"}),e.jsx("div",{children:e.jsx(w,{to:"/forget-password",className:"forget-link","aria-label":"Forget password",title:"Forget password",children:"Forgot password ?"})})]}),e.jsxs("div",{className:"mt-2 relative",children:[e.jsx("input",{id:"password",name:"password",type:o?"text":"password",placeholder:"password",className:"form-input",value:a.password,onChange:s}),e.jsx("span",{className:"absolute top-1/2 right-4 -translate-y-1/2 cursor-pointer h-12 w-12 flex justify-center items-center rounded-full hover:bg-gray-100",onClick:()=>m(!o),children:o?e.jsx(S,{className:"h-8 w-8 fill-[#83848a]"}):e.jsx(k,{className:"h-8 w-8 fill-[#83848a]"})})]}),t.password&&e.jsx("p",{className:"error-label",children:t.password})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"login-btn",title:"login","aria-label":"login",onClick:l=>N(l),disabled:c,children:c?e.jsxs("div",{className:"login-animation",children:[e.jsx("span",{children:" "}),e.jsx("span",{children:" "}),e.jsx("span",{children:" "})]}):"Login"})}),e.jsxs("p",{className:"text-center text-xl text-[#83848a]",children:["Don't have any account ?",e.jsx(w,{to:"/signup",className:"ml-4 text-[#818cf8]","aria-label":"register now",title:"register",children:"Register"})]})]})})};export{O as default};
