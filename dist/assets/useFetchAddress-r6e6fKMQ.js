import{r as x,_ as o,P as t,u as v,j as e,F,aC as q,aD as C,f as S,aE as $}from"./index-BHmYt6bW.js";import{c as E,a as h}from"./index.esm-DzoCB4FC.js";import{b as P}from"./index-XCQUsxe0.js";const L=()=>{const[m,c]=x.useState(!1),s="http://35.154.167.170:3000",l=localStorage.getItem("token");return{addAddress:async n=>{var r;if(!l)return o.error("User is not authenticated!"),null;const d={...n,address_type:parseInt(n.address_type)};try{c(!0);const u=await fetch(`${s}/address`,{method:"POST",headers:{"Content-type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(d)}),a=await u.json();return u.ok?(o.success(a==null?void 0:a.message,{className:"toast-success"}),(r=a==null?void 0:a.data)==null?void 0:r.result):(o.error("Failed to add address!",{className:"toast-error"}),null)}catch{return o.error("Failed to add address!"),null}finally{c(!1)}},loading:m}},D=()=>{const[m,c]=x.useState(!1),s="http://35.154.167.170:3000",l=localStorage.getItem("token");return{loading:m,editAddress:async(n,d)=>{if(!l)return o.error("User is not authenticated!"),null;const r={...n,address_type:Number(n.address_type),pincode:String(n.pincode)};try{c(!0);const u=await fetch(`${s}/address/${d}`,{method:"PUT",headers:{"Content-type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(r)}),a=await u.json();return u.ok?(o.success(a.message),a):(o.error(a.message,{style:{maxWidth:"700px"}}),null)}catch{return o.error("Unable to update address"),null}finally{c(!1)}}}},U=E().shape({full_name:h().trim().min(6,"Full name must be at least 2 characters").max(50,"Full name cannot exceed 50 characters").required("Full name is required"),phone_number:h().matches(/^[0-9]{10}$/,"Phone number must be exactly 10 digits").required("Phone number is required"),address_type:h().required("Address type is require"),building_number:h().trim().required("Building number is required"),area:h().trim().required("Area is required"),landmark:h().trim().required("Landmark is required"),city:h().trim().required("City is required"),state:h().trim().required("State is required"),country:h().trim().required("Country is required"),pincode:h().matches(/^\d{6}$/,"Pincode must be exactly 6 digits").required("Pincode is required")}),R=({setIsOpen:m,isOpen:c,address:s,isEditMode:l})=>{const b=v(),{addAddress:n,loading:d}=L(),{editAddress:r,loading:u}=D(),[a,A]=x.useState({}),[i,y]=x.useState({full_name:"",phone_number:"",address_type:"1",building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:""}),p=j=>{const{name:g,value:f}=j.target;y({...i,[g]:f})},k=async j=>{j.preventDefault();try{await U.validate(i,{abortEarly:!1})}catch(f){if(f.inner){const N={};f.inner.forEach(_=>{N[_.path]=_.message}),A(N)}return}if(l){const{address_id:f}=s;if(await r(i,f)){b(q({formData:i,address_id:f})),m(!1);return}}const g=await n(i);g&&(b(C(g)),m(!1))},w=()=>{m(!1),y({address_type:"1",full_name:"",phone_number:"",building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:""})};return x.useEffect(()=>{s&&y({full_name:s.full_name,phone_number:s.phone_number,address_type:s.address_type,building_number:s.building_number,area:s.area,landmark:s.landmark,pincode:s.pincode,city:s.city,state:s.state,country:s.country})},[s]),e.jsx("section",{className:`fixed inset-0 p-8 bg-black bg-opacity-75 grid place-items-center min-h-screen w-full overflow-auto z-50 mb-l:p-6 ${c?"block":"hidden"}`,children:e.jsxs("div",{className:"w-full max-w-[60rem] bg-white shadow-2xl p-12 pb-16 rounded-2xl tab-l:rounded-xl mb-l:rounded-lg mb-l:p-10 mb:p-8",children:[e.jsxs("div",{className:"mb-10 flex justify-between items-center flex-wrap tab-l:mb-8",children:[e.jsx("h2",{className:"text-[2.4rem] leading-[1] text-[var(--black)] tab-l:text-[2rem]",children:l?"Edit Address":"Add New Address"}),e.jsx("button",{type:"button",title:"close",className:"border border-gray-300 rounded-md inline-flex items-center justify-center text-gray-400 focus:outline-none focus:border-indigo-500 shadow-2xl h-10 w-10",onClick:w,children:e.jsx(P,{className:"h-8 w-8 tab-s:h-6 tab-s:w-6"})})]}),e.jsxs("form",{onSubmit:k,className:"grid grid-cols-[repeat(auto-fill,_minmax(25rem,_1fr))] w-full gap-x-10 gap-y-12 tab-s:gap-10 mb-l:grid-cols-1 mb:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"full_name",className:"aam-label",children:"Fullname"}),e.jsxs("div",{children:[e.jsx("input",{name:"full_name",id:"full_name",type:"text",onChange:p,value:i.full_name,className:"aam-input"}),a.full_name&&e.jsx("p",{className:"aam-error-label",children:a.full_name})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"phone_number",className:"aam-label",children:"Phone number"}),e.jsxs("div",{children:[e.jsx("input",{name:"phone_number",id:"phone_number",type:"text",onChange:p,value:i.phone_number,className:"aam-input"}),a.phone_number&&e.jsx("p",{className:"aam-error-label",children:a.phone_number})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"address_type",className:"aam-label",children:"Address type"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"address_type",id:"address_type",className:"aam-input appearance-none",onChange:p,defaultValue:1,children:[e.jsx("option",{value:1,children:"Home"}),e.jsx("option",{value:2,children:"Office"}),e.jsx("option",{value:3,children:"Other"})]}),e.jsx(F,{className:"absolute top-1/2 right-3 transform -translate-y-1/2 text-gray-500 pointer-events-none"}),a.address_type&&e.jsx("p",{className:"aam-error-label",children:a.address_type})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"building_number",className:"aam-label",children:"Building number"}),e.jsxs("div",{children:[e.jsx("input",{name:"building_number",id:"building_number",type:"text",onChange:p,value:i.building_number,className:"aam-input"}),a.building_number&&e.jsx("p",{className:"aam-error-label",children:a.building_number})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"area",className:"aam-label",children:"area"}),e.jsxs("div",{children:[e.jsx("input",{name:"area",id:"area",type:"text",onChange:p,value:i.area,className:"aam-input"}),a.area&&e.jsx("p",{className:"aam-error-label",children:a.area})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"landmark",className:"aam-label",children:"landmark"}),e.jsxs("div",{children:[e.jsx("input",{name:"landmark",id:"landmark",type:"text",onChange:p,value:i.landmark,className:"aam-input"}),a.landmark&&e.jsx("p",{className:"aam-error-label",children:a.landmark})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"pincode",className:"aam-label",children:"pincode"}),e.jsxs("div",{children:[e.jsx("input",{name:"pincode",id:"pincode",type:"text",onChange:p,value:i.pincode,className:"aam-input"}),a.pincode&&e.jsx("p",{className:"aam-error-label",children:a.pincode})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"city",className:"self-start text-[1.2rem] text-[var(--black)]",children:"city"}),e.jsxs("div",{children:[e.jsx("input",{name:"city",id:"city",type:"text",onChange:p,value:i.city,className:"aam-input"}),a.city&&e.jsx("p",{className:"aam-error-label",children:a.city})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"state",className:"aam-label",children:"state"}),e.jsxs("div",{children:[e.jsx("input",{name:"state",id:"state",type:"text",onChange:p,value:i.state,className:"aam-input"}),a.state&&e.jsx("p",{className:"aam-error-label",children:a.state})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"country",className:"aam-label",children:"country"}),e.jsx("input",{name:"country",id:"country",type:"text",onChange:p,value:i.country,className:"aam-input"}),a.country&&e.jsx("p",{className:"aam-error-label",children:a.country})]}),e.jsx("div",{className:"flex justify-start items-end",children:e.jsx("button",{type:"submit",className:"text-white bg-primary text-[1.4rem] font-medium px-6 py-4 rounded-md flex gap-4 items-center",disabled:d||u,children:l?u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-block h-10 w-10 rounded-full border-4 border-t-white border-white/30 animate-spin"}),e.jsx("span",{children:"Processing..."})]}):"Edit Address":d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-block h-10 w-10 rounded-full border-4 border-t-white border-white/30 animate-spin"}),e.jsx("span",{children:"Processing..."})]}):"Add Address"})})]})]})})};R.propTypes={setIsOpen:t.func.isRequired,isOpen:t.bool.isRequired,address:t.shape({address_id:t.number,full_name:t.string,phone_number:t.string,address_type:t.oneOfType([t.number,t.string]),building_number:t.string,area:t.string,landmark:t.string,pincode:t.number,city:t.string,state:t.string,country:t.string}),isEditMode:t.bool.isRequired};const O=()=>{const[m,c]=x.useState(!1),s="http://35.154.167.170:3000",l=localStorage.getItem("token");return{deleteAddress:async n=>{if(!n){o.error("Address Id is required to delete address");return}try{c(!0);const d=await fetch(`${s}/address/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${l}`}}),r=await d.json();return d.ok?(o.success((r==null?void 0:r.message)||"Address deleted successfully"),r==null?void 0:r.data):null}catch{return o.error("Unable to delete address, please try again later!"),null}finally{c(!1)}},loading:m}},z=()=>{const m=v(),c=S(d=>{var r;return(r=d==null?void 0:d.auth)==null?void 0:r.isAuthenticated}),[s,l]=x.useState(!0),b="http://35.154.167.170:3000",n=localStorage.getItem("token");return x.useEffect(()=>{if(!c||!n){l(!1);return}(async()=>{var r;try{const u=await fetch(`${b}/address`,{method:"GET",headers:{Authorization:`Bearer ${n}`}}),a=await u.json();u.ok?m($((r=a==null?void 0:a.data)==null?void 0:r.result)):o.error("Failed to fetch address data!")}catch{o.error("Failed to fetch address data!")}finally{l(!1)}})()},[c,b,m,n]),{loading:s}};export{R as A,O as a,z as u};
