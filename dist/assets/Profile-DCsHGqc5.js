import{_ as u,r as i,u as I,j as e,am as R,c as $}from"./index-CtdI_EyE.js";import{L as A}from"./Loading-BVid2nT1.js";const E=()=>{const m="http://35.154.167.170:3000",c=localStorage.getItem("token");return{getUserDetail:async()=>{try{const d=await fetch(`${m}/user/customer`,{method:"GET",headers:{Authorization:`Bearer ${c}`}}),g=await d.json();if(d.ok)return g.data;u.error("Unable to retrieve user details. Please try again later.",{className:"toast-error"})}catch{u.error("Failed to fetch user information. Please check your connection.",{className:"toast-error"})}}}},B=()=>{const[m,c]=i.useState(!1),b="http://35.154.167.170:3000",d=localStorage.getItem("token");return{updateUserDetail:async s=>{var f;c(!0);let l=new FormData;l.append("first_name",s.first_name),l.append("last_name",s.last_name),l.append("email",s.email),l.append("mobile_number",s.mobile_number),l.append("gender",s.gender),s.image&&l.append("image",s.image),s.id_proof&&l.append("id_proof",s.id_proof);try{const x=await fetch(`${b}/user/customer`,{method:"PUT",headers:{Authorization:`Bearer ${d}`},body:l}),r=await x.json();return x.ok?(u.success("Your profile details have been successfully updated!",{className:"toast-success"}),(f=r==null?void 0:r.data)==null?void 0:f.user):(u.error("Unable to update your profile at the moment. Please try again later.",{className:"toast-error"}),null)}catch{return u.error("Profile update failed! Please check the information and try again.",{className:"toast-error"}),null}finally{c(!1)}},loading:m}},G=()=>{const m=I(),{getUserDetail:c}=E(),{updateUserDetail:b,loading:d}=B(),[g,s]=i.useState(null),[l,f]=i.useState(null),[x,r]=i.useState(!1),[y,j]=i.useState(!0),[_,U]=i.useState(!1),[t,p]=i.useState({first_name:"",last_name:"",email:"",mobile_number:"",gender:0,id_proof:null,image:null}),w=async n=>{if(n.preventDefault(),x){const a=await b(t);a&&(m($(a)),U(o=>!o))}},h=n=>{const{name:a,value:o}=n.target;a=="gender"?(r(!0),p({...t,[a]:Number(o)})):(r(!0),p({...t,[a]:o}))},k=n=>{let a=n.target.files[0];a&&(r(!0),p({...t,id_proof:a}))},F=n=>{let a=n.target.files[0];if(a){r(!0);const o=URL.createObjectURL(a);s(o),p({...t,image:a})}};return i.useEffect(()=>{j(!0),(async()=>{const a=await c();if(a){const{first_name:o,last_name:P,email:C,mobile_number:S,gender:D,image:N,id_proof:v}=a.user;p({first_name:o,last_name:P,email:C,mobile_number:S,gender:D});const L=N||"/default_pfp.png";v&&f(v),s(L),j(!1)}})()},[_]),y?e.jsx(A,{}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"dash-section-head mb-8 laptop-m:mb-6 laptop-s:mb-5 tab-l:mb-6 mb:mb-4",children:"Customer Master - Details"}),e.jsx("div",{className:"cus-detail-container",children:e.jsxs("div",{className:"p-14 flex items-start gap-20 laptop-m:p-12 laptop-m:gap-16 laptop:gap-12 laptop-s:p-10 laptop-s:gap-10 tab-l:p-8 tab-l:gap-8 tab-s:flex-col tab-s:p-10 tab:p-8 mb:p-6 mb:gap-6",children:[e.jsxs("div",{className:"profile-img-container",children:[e.jsx("img",{src:g,alt:"Avatar",className:"h-full w-full rounded-full border-[1.5px] border-[var(--black)] laptop-s:border"}),e.jsx("button",{className:"edit-profile-img",onClick:()=>document.getElementById("profileImageInput").click(),children:e.jsx(R,{className:"inline-block h-8 w-8 fill-white laptop-m:h-7 laptop-m:w-7 tab-l:h-5 tab-l:w-5 mb:h-4 mb:w-4"})}),e.jsx("input",{type:"file",id:"profileImageInput",className:"hidden",accept:"image/*",onChange:F})]}),e.jsx("div",{className:"grow tab-s:self-stretch",children:e.jsx("form",{className:"user-detail",onSubmit:w,children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-12 gap-y-14 laptop-s:gap-x-10 laptop-s:gap-y-12 tab-l:gap-x-8 tab-l:gap-y-10 tab-s:grid-cols-[repeat(auto-fill,_minmax(22.5rem,_1fr))] tab-s:gap-10 tab:grid-cols-[repeat(auto-fill,_minmax(20rem,_1fr))] tab:gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"firstname",children:"first name"}),e.jsx("input",{id:"firstname",type:"text",name:"first_name",value:t.first_name,onChange:h,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none mb:border"})]}),e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"lastname",children:"last name"}),e.jsx("input",{id:"lastname",type:"text",name:"last_name",value:t.last_name,onChange:h,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none mb:border"})]}),e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"email",children:"email"}),e.jsx("input",{readOnly:!0,id:"email",type:"text",name:"email",value:t.email,className:"readonly-input border-[1.5px] border-indigo-200 focus:outline-none mb:border"})]}),e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"mobile",children:"mobile"}),e.jsx("input",{readOnly:!0,id:"mobile",type:"text",name:"mobile_number",value:t.mobile_number,className:"readonly-input border-[1.5px] border-indigo-200 focus:outline-none mb:border"})]}),e.jsxs("div",{className:"col-span-2 flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2 tab-s:col-span-1",children:[e.jsx("label",{htmlFor:"document",children:"Update/Add document"}),e.jsx("input",{id:"document",type:"file",onChange:k,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none mb:border"}),l&&e.jsx("div",{className:"flex items-start",children:e.jsx("a",{href:l,className:"inline-block text-indigo-600 hover:underline laptop-m:text-[1.4rem] tab-l:text-xl mb:text-base",target:"__blank",children:"view document"})})]}),e.jsxs("div",{className:"flex flex-col gap-4 laptop-s:gap-3 tab-l:gap-2",children:[e.jsx("label",{htmlFor:"gender",children:"gender"}),e.jsxs("div",{className:"grow flex items-stretch justify-start gap-8 laptop-m:gap-6 mb:gap-4",children:[e.jsxs("label",{htmlFor:"male",className:`flex items-center justify-center gap-4 border  py-[1.25rem] rounded-lg px-4 tab-l:p-4 mb:p-3 ${t.gender==1?"border-[var(--black)]":" border-indigo-300"}`,children:[e.jsx("input",{id:"male",type:"radio",name:"gender",value:1,onChange:h,checked:t.gender==1,className:"user-gender-radio"}),e.jsx("span",{className:"text-[1.5rem] leading-[1.7rem] text-[var(--black)] laptop-m:text-[1.4rem] tab-l:text-xl mb:text-base",children:"Male"})]}),e.jsxs("label",{htmlFor:"female",className:`flex items-center justify-center gap-4 border py-[1.25rem] rounded-lg px-4 tab-l:p-4 mb:p-3 ${t.gender==2?"border-[var(--black)]":" border-indigo-300"}`,children:[e.jsx("input",{id:"female",type:"radio",name:"gender",value:2,onChange:h,checked:t.gender==2,className:"user-gender-radio"}),e.jsx("span",{className:"text-[1.5rem] leading-[1.7rem] text-[var(--black)] laptop-m:text-[1.4rem] tab-l:text-xl mb:text-base",children:"Female"})]})]})]}),e.jsx("div",{className:"col-span-2 tab-s:col-span-1",children:e.jsx("button",{className:"update-btn",type:"submit",disabled:d,children:d?"updating...":"update"})})]})})})]})})]})};export{G as default};
