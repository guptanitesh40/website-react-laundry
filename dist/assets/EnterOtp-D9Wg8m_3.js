import{r as p,_ as g,a as v,d as y,j as t}from"./index-D8wRbMS6.js";const j=()=>{const[c,a]=p.useState(""),l="http://3.110.208.70:3000",m=localStorage.getItem("token");return{validateOtp:async(i,u)=>{try{a(!0);const o=await fetch(`${l}/user/validate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},body:JSON.stringify({mobile_number:u,otp:i})}),r=await o.json();return o.ok?{success:!0}:(g.error(r.message,{className:"toast-error"}),{success:!1})}catch{return g.error("Failed to validate otp!",{className:"toast-error"}),{success:!1}}finally{a(!1)}},loading:c}},w=()=>{var f;const c=v(),a=y(),l=(f=a==null?void 0:a.state)==null?void 0:f.mobileNumber,m=String(l).slice(-3),{validateOtp:d,loading:i}=j(),[u,o]=p.useState(),r=p.useRef([]),h=(e,s)=>{e.target.value.length>1&&(e.target.value=e.target.value[0]),e.target.value!==""&&s<r.current.length-1&&r.current[s+1].focus()},x=(e,s)=>{e.key==="Backspace"&&s>0&&e.target.value===""&&r.current[s-1].focus()},b=async()=>{const e=r.current.map(n=>n.value).join("");if(!e){o("please enter you otp");return}if(e.length!==6){o("Otp must be 6 digits");return}o(""),(await d(e,l)).success&&c("/reset-password",{state:{mobile_number:l,otp:e}})};return p.useEffect(()=>{a.state||c("/login")},[a.state,c]),t.jsx("section",{className:"bg-white grid place-items-center p-6 min-h-screen w-full overflow-auto tab:p-8 mb-l:p-6 mb:p-4",children:t.jsxs("div",{className:"enter-mobile-container",children:[t.jsx("h2",{className:"text-center text-[2.4rem] leading-[1.5] font-bold text-[var(--black)] mb-12 laptop-l:text-[2rem] mb-l:text-[1.8rem] mb-l:mb-8",children:"Forget password"}),t.jsx("p",{className:"text-2xl",children:"Verify your phone number"}),t.jsx("p",{className:"verify-text2",children:"We have send you an SMS with 6 digits"}),t.jsxs("div",{className:"otp-boxes-container flex flex-col gap-6 mb-l:gap-4",children:[t.jsx("p",{className:"text-[#83848a]",children:"code sent to"}),t.jsxs("span",{className:"font-bold text-center text-[var(--primary)]",children:["+91 *****",m]}),t.jsx("div",{className:"boxes",children:[...Array(6)].map((e,s)=>t.jsx("input",{type:"text",className:"box new-box text-[var(--primary)] focus:ring-2 focus:ring-indigo-600 mb-l:focus:ring-1",maxLength:1,ref:n=>r.current[s]=n,onChange:n=>h(n,s),onKeyDown:n=>x(n,s)},s))})]}),u&&t.jsx("p",{className:"otp-error-label",children:u}),t.jsx("div",{children:t.jsx("button",{className:"new-verift-button",onClick:b,disabled:i,children:i?"verifying...":"verify"})})]})})};export{w as default};
